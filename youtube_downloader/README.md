# YouTube Downloader & Transcription/Translation App

## プロジェクト概要

本プロジェクトは、YouTube の動画をコマンドラインからダウンロードするスクリプト（downloader.py）および、動画の音声を抜き出して文字起こしと翻訳を行うウェブアプリケーション（app.py）を提供します。  
初心者の方でも安心して利用できるよう、エラーが発生しない環境構築と実行手順を詳細に記述しています。

## 必要環境

- **OS**: Windows（Cursor などのエディタ内ターミナル利用推奨）
- **Python**: 3.6 以降（推奨: Python 3.13）
- **インターネット接続**: YouTube 及び API 利用のために必須

## 必要な依存ライブラリ

基本的な動画ダウンロード機能を実現するため、以下のライブラリが必要です：

- pytube  
- yt-dlp  
- ffmpeg-python  

※なお、ウェブアプリケーションとして利用する場合は、以下の追加ライブラリも必要になります（オプション）：
- fastapi  
- uvicorn  
- python-multipart  
- python-dotenv  
- openai-whisper  
- openai  
- jinja2  

※シンプルな機能実装の場合は、`requirements.txt` に記載された以下の3ライブラリのみで十分です。なお、以前の依存関係状態は「requirements_v1.txt」として保存済みです。

## プロジェクトファイル構成

プロジェクトは以下の構成になっています。  
※各ファイル・フォルダ名は変更しないように注意してください。

- **README.md**  
  詳細な要件書や実行手順を記載しています。  

- **requirements.txt**  
  本プロジェクトで必要な依存ライブラリ（pytube, yt-dlp, ffmpeg-python）を記載。

- **requirements_v1.txt**  
  今までの状態を保存したバージョンファイルです。

- **downloader.py**  
  コマンドラインから YouTube 動画をダウンロードするためのスクリプト。  
  ※ pytube で動画情報を取得し、エラー時は yt-dlp でダウンロードを試みます。

- **app.py**  
  FastAPI を用いて、動画の音声をダウンロード後に文字起こしおよび英訳するウェブアプリケーション。  
  裏では yt-dlp、whisper、openai API を利用します。

- **templates/**  
  ウェブアプリケーション用の HTML テンプレートが格納されています。

- **downloads/**  
  ダウンロードした動画および音声ファイルの保存先ディレクトリ。

- **outputs/**  
  文字起こしと翻訳結果を Markdown ファイルとして保存する出力先ディレクトリ。

- **.gitignore**  
  Git 管理外にするファイル・ディレクトリの設定ファイルです。

## セットアップ手順

### 1. プロジェクトの配置

Cursor 内または任意のエディタで、プロジェクトフォルダ `youtube_downloader` を開いてください。  
配置後、ファイル構成が上記と一致しているか必ず確認してください。

### 2. 仮想環境の構築（推奨）

依存ライブラリの管理や環境の衝突を避けるため、仮想環境の利用を強くおすすめします。

**PowerShell を使用する場合:**

1. プロジェクトフォルダ内で仮想環境を作成します。

   ```
   python -m venv venv
   ```

2. 仮想環境をアクティブ化します。  
   ※ Windows の PowerShell では以下のコマンドを実行してください。

   ```
   .\venv\Scripts\Activate.ps1
   ```

   ※ 初回の場合、スクリプト実行ポリシーの変更が必要な場合があります。その場合は下記コマンドを実行し、「Y」を入力してください。

   ```
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```

### 3. 依存ライブラリのインストール

仮想環境をアクティブにした状態で、プロジェクトフォルダ内にある `requirements.txt` を使ってインストールします。

```
pip install -r requirements.txt
```


※ インストール中にモジュールが見つからない場合は、各ライブラリ（例: pytube, yt-dlp, ffmpeg-python）が正しく記載されているかと、仮想環境が正しくアクティブ化されているかを確認してください。

### 4. プロジェクトの実行

#### (a) コマンドラインでの動画ダウンロード

1. ターミナルでプロジェクトフォルダ `youtube_downloader` に移動します。

   ```
   cd youtube_downloader
   ```

2. 以下のコマンドで動画のダウンロードを実行します。

   ```
   python downloader.py "https://youtu.be/動画ID"
   ```

   例:

   ```
   python downloader.py "https://youtu.be/oFzpVOKdrSE?si=EETlpC1Jm1wD9Q9T"
   ```

#### (b) ウェブアプリケーションとしての実行

1. FastAPI を使ってローカルサーバーを起動します（仮想環境がアクティブな状態で）。

   ```
   uvicorn app:app --reload
   ```

2. ブラウザで [http://localhost:8000](http://localhost:8000) にアクセスしてください。  
　ウェブインターフェースを通じて、動画の文字起こし・翻訳処理が実行できます。

## トラブルシューティング

- **ModuleNotFoundError**  
  「必要なモジュールが見つからない」というエラーが発生した場合、  
  ※ 仮想環境が正しくアクティブになっているか  
  ※ `pip install -r requirements.txt` を再度実行し依存ライブラリがインストールされているか確認してください。

- **ファイルパスエラー**  
  実行時に「can't open file」のエラーが出た場合、正しいディレクトリに移動してから実行してください。  
  例: `downloader.py` は必ず `youtube_downloader` フォルダ内に存在することを確認。

- **YouTube アクセスエラー**  
  ネットワーク環境の問題や特定の動画にアクセス制限がかかっている場合があるため、別のURLで試行してください。

- **その他のエラー**  
  エラーメッセージをよく読み、必要に応じて公式ドキュメントやコミュニティでの情報を参照してください。  

## その他の注意点

- API キー（OpenAI などの機密情報）は、必ず `.env` ファイルや環境変数を使用して安全に管理してください。
- ファイル構成に変更がある場合は、各スクリプト内のパス設定も適切に更新すること。
- 初めて実行する際は、一つ一つの手順を丁寧に確認しながら進めることをおすすめします。

## 最後に

このプロジェクトは、YouTube 動画のダウンロードから文字起こし、翻訳まで一連の操作をシンプルに行えるよう設計されています。  
初めは戸惑うかもしれませんが、記載された手順に従って丁寧に設定すれば必ず動作します。  
あなたの成功を心から応援しています！💪✨  

もし疑問点や問題があれば、気軽に問い合わせてくださいね。安心してプロジェクトを進められるよう、全力でサポートいたします！